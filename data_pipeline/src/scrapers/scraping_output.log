/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/fields/__init__.py:1595: RuntimeWarning: DateTimeField ScrapingJob.completed_at received a naive datetime (2025-07-21 16:23:46.790129) while time zone support is active.
  warnings.warn(
Traceback (most recent call last):
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/base/base.py", line 308, in _cursor
    return self._prepare_cursor(self.create_cursor(name))
                                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/postgresql/base.py", line 330, in create_cursor
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/psycopg/connection.py", line 853, in cursor
    self._check_connection_ok()
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/psycopg/connection.py", line 489, in _check_connection_ok
    raise e.OperationalError("the connection is closed")
psycopg.OperationalError: the connection is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/iamai/projects/portfolio_app/data_pipeline/src/scrapers/michelin_csv_processor.py", line 192, in process_csv_file
    job.save()
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/base.py", line 814, in save
    self.save_base(
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/base.py", line 877, in save_base
    updated = self._save_table(
              ^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/base.py", line 990, in _save_table
    updated = self._do_update(
              ^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/base.py", line 1054, in _do_update
    return filtered._update(values) > 0
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/query.py", line 1231, in _update
    return query.get_compiler(self.db).execute_sql(CURSOR)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/sql/compiler.py", line 1984, in execute_sql
    cursor = super().execute_sql(result_type)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/sql/compiler.py", line 1560, in execute_sql
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/base/base.py", line 330, in cursor
    return self._cursor()
           ^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/base/base.py", line 307, in _cursor
    with self.wrap_database_errors:
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/base/base.py", line 308, in _cursor
    return self._prepare_cursor(self.create_cursor(name))
                                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/postgresql/base.py", line 330, in create_cursor
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/psycopg/connection.py", line 853, in cursor
    self._check_connection_ok()
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/psycopg/connection.py", line 489, in _check_connection_ok
    raise e.OperationalError("the connection is closed")
django.db.utils.OperationalError: the connection is closed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/base/base.py", line 308, in _cursor
    return self._prepare_cursor(self.create_cursor(name))
                                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/postgresql/base.py", line 330, in create_cursor
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/psycopg/connection.py", line 853, in cursor
    self._check_connection_ok()
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/psycopg/connection.py", line 489, in _check_connection_ok
    raise e.OperationalError("the connection is closed")
psycopg.OperationalError: the connection is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<string>", line 15, in <module>
  File "/Users/iamai/projects/portfolio_app/data_pipeline/src/scrapers/michelin_csv_processor.py", line 202, in process_csv_file
    job.save()
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/base.py", line 814, in save
    self.save_base(
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/base.py", line 877, in save_base
    updated = self._save_table(
              ^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/base.py", line 990, in _save_table
    updated = self._do_update(
              ^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/base.py", line 1054, in _do_update
    return filtered._update(values) > 0
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/query.py", line 1231, in _update
    return query.get_compiler(self.db).execute_sql(CURSOR)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/sql/compiler.py", line 1984, in execute_sql
    cursor = super().execute_sql(result_type)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/models/sql/compiler.py", line 1560, in execute_sql
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/base/base.py", line 330, in cursor
    return self._cursor()
           ^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/base/base.py", line 307, in _cursor
    with self.wrap_database_errors:
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/base/base.py", line 308, in _cursor
    return self._prepare_cursor(self.create_cursor(name))
                                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/utils/asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/django/db/backends/postgresql/base.py", line 330, in create_cursor
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/psycopg/connection.py", line 853, in cursor
    self._check_connection_ok()
  File "/Users/iamai/projects/portfolio_app/.venv/lib/python3.11/site-packages/psycopg/connection.py", line 489, in _check_connection_ok
    raise e.OperationalError("the connection is closed")
django.db.utils.OperationalError: the connection is closed
API key looks good.
Warning: CSV file not found at ingestion/michelin_my_maps.csv
Starting continuous scraping process...
[INFO] Trying to switch language to English for https://www.restaurantboury.be/
[INFO] Clicking language switch button: menu / https://www.restaurantboury.be/menu
[DEBUG] Final URL after language switch: https://www.restaurantboury.be/menu
[INFO] No English language switch button found, proceeding with default language.
[INFO] No English language switch button found, proceeding with default language.
[INFO] No English language switch button found, proceeding with default language.
[INFO] Trying to switch language to English for https://www.ambroisie-paris.com/
[INFO] Clicking language switch button: en savoir plus. / https://www.ambroisie-paris.com/mentions-legales/
[DEBUG] Final URL after language switch: https://www.ambroisie-paris.com/mentions-legales/
[INFO] Trying to switch language to English for https://www.ambroisie-paris.com/
[INFO] Clicking language switch button: en savoir plus. / https://www.ambroisie-paris.com/mentions-legales/
[DEBUG] Final URL after language switch: https://www.ambroisie-paris.com/mentions-legales/
[INFO] Trying to switch language to English for https://www.oetkercollection.com/fr/hotels/le-bristol-paris/restaurants-et-bar/epicure/
[INFO] Clicking language switch button: en savoir plus / 
[DEBUG] Final URL after language switch: https://www.oetkerhotels.com/fr/hotels/le-bristol-paris/restaurants-et-bar/epicure/
[INFO] Trying to switch language to English for https://www.oetkercollection.com/fr/hotels/le-bristol-paris/restaurants-et-bar/epicure/
[INFO] Clicking language switch button: en savoir plus / 
[DEBUG] Final URL after language switch: https://www.oetkerhotels.com/fr/hotels/le-bristol-paris/restaurants-et-bar/epicure/
[INFO] No English language switch button found, proceeding with default language.
[INFO] No English language switch button found, proceeding with default language.
[INFO] Trying to switch language to English for https://www.leprecatelan.com/
[INFO] Clicking language switch button: aller au contenu principal / https://leprecatelan.paris/#main-content
[INFO] Clicking language switch button: votre événement - demande de devis / https://leprecatelan.paris/contact
[INFO] Clicking language switch button: en / https://leprecatelan.paris/en
[INFO] Clicking language switch button: groupe lenôtre / https://leprecatelan.paris/node/38
[INFO] Clicking language switch button: politique de confidentialité / https://leprecatelan.paris/node/36
[INFO] Clicking language switch button: nos engagements / https://leprecatelan.paris/engagements-rse
[INFO] Clicking language switch button: lenôtre / https://www.lenotre.com/
[INFO] Clicking language switch button: groupe lenôtre / https://leprecatelan.paris/node/38
[INFO] Clicking language switch button: politique de confidentialité / https://leprecatelan.paris/node/36
[INFO] Clicking language switch button: en / https://leprecatelan.paris/en
[INFO] Clicking language switch button: nos engagements / https://leprecatelan.paris/engagements-rse
[INFO] Clicking language switch button: lenôtre / https://www.lenotre.com/
[INFO] Clicking language switch button: mentions légales / https://leprecatelan.paris/mentions-legales
[INFO] Clicking language switch button: confidentialité / https://leprecatelan.paris/politique-de-confidentialite
[INFO] No English language switch button clicked.
[INFO] Language switch button clicked but no success or no page change, proceeding with current language.
[INFO] Trying to switch language to English for https://www.leprecatelan.com/
[INFO] Clicking language switch button: aller au contenu principal / https://leprecatelan.paris/#main-content
[INFO] Clicking language switch button: votre événement - demande de devis / https://leprecatelan.paris/contact
[INFO] Clicking language switch button: en / https://leprecatelan.paris/en
[INFO] Clicking language switch button: groupe lenôtre / https://leprecatelan.paris/node/38
[INFO] Clicking language switch button: politique de confidentialité / https://leprecatelan.paris/node/36
[INFO] Clicking language switch button: nos engagements / https://leprecatelan.paris/engagements-rse
[INFO] Clicking language switch button: lenôtre / https://www.lenotre.com/
[INFO] Clicking language switch button: groupe lenôtre / https://leprecatelan.paris/node/38
[INFO] Clicking language switch button: politique de confidentialité / https://leprecatelan.paris/node/36
[INFO] Clicking language switch button: en / https://leprecatelan.paris/en
[INFO] Clicking language switch button: nos engagements / https://leprecatelan.paris/engagements-rse
[INFO] Clicking language switch button: lenôtre / https://www.lenotre.com/
[INFO] Clicking language switch button: mentions légales / https://leprecatelan.paris/mentions-legales
[INFO] Clicking language switch button: confidentialité / https://leprecatelan.paris/politique-de-confidentialite
[INFO] Clicking language switch button: cookie settings cookie settings, opens the preference center dialog / 
[DEBUG] Final URL after language switch: https://leprecatelan.paris/
[INFO] Trying to switch language to English for https://www.fourseasons.com
[INFO] Clicking language switch button: reopen / https://www.fourseasons.com/#
[INFO] Clicking language switch button: menu / 
[INFO] Clicking language switch button: legal notice legal information, opens in a new tab / https://www.fourseasons.com/legal/
[DEBUG] Final URL after language switch: https://www.fourseasons.com/
[INFO] Trying to switch language to English for https://www.fourseasons.com
[INFO] Clicking language switch button: reopen / https://www.fourseasons.com/#
[DEBUG] Final URL after language switch: https://www.fourseasons.com/#
